{extend name="base" /}
<!--高亮选中效果-->
{block name="current_index"}goods,goods.index/index{/block}

{block name="content"}

<div class="box box-primary">
    <!-- /.box-header -->
    <div class="box-header with-border">
        <ul class="nav nav-tabs">
            <li class="active"><a href="#goods_info" data-toggle="tab" aria-expanded="true">商品信息</a></li>
            <li class=""><a href="#goods_content" data-toggle="tab" aria-expanded="false">详情介绍</a></li>
            <li class=""><a href="#goods_spec" data-toggle="tab" aria-expanded="false">规格属性</a></li>
        </ul>
    </div>
    <!-- form start -->
    <form id="form" action="" class="form-horizontal">
        <div class="box-body tab-content">
            <input type="hidden" name="id" value="{$model['id']}"/>
            <!--商品主要信息-->
            <div class="tab-pane active" id="goods_info">
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品名称</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="商品名称" name="goods_name" value="{$model['goods_name']}">
                    </div>
                </div>
                <!--简介-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品简介</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="商品简介" name="goods_brief" value="{$model['goods_brief']}">
                    </div>
                </div>
                <!--分类-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">选择分类</label>
                    <div class="col-sm-10">
                        <select name="pid" class="form-control">
                            <option value="0">请选择分类</option>
                            {volist name="cate" id="vo"}
                            <option value="{$vo['id']}"  {:$model['cate_id']==$vo['id']?'selected':''} >{$vo['cate_name']}</option>
                                {volist name="vo['link_child_cate']" id="child"}
                                <option value="{$child['id']}"  {:$model['cate_id']==$child['id']?'selected':''} >|—— {$child['cate_name']}</option>
                                    {volist name="child['link_child_cate']" id="childs"}
                                    <option value="{$childs['id']}"  {:$model['cate_id']==$childs['id']?'selected':''} >|——|——  {$childs['cate_name']}</option>
                                    {/volist}
                                {/volist}
                            {/volist}
                        </select>
                    </div>
                </div>
                <!--主图、组图-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品图</label>
                    <div class="col-sm-10">
                        <input type="hidden" name="goods_image" value="{$model['goods_image']}" />
                        <button type="button" class="layui-btn upload-img" lay-data="{ url: '{:url('upload/upload',['type'=>'goods'])}', accept: 'images'}">
                            <i class="layui-icon">&#xe67c;</i>商品图
                        </button>
                        <img width="100" height="100" src="{$model['goods_image']}" />
                    </div>
                </div>
                <!--商品价格-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品原价</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="商品原价" name="original_price" value="{$model['original_price']}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品现价</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="商品现价" name="price" value="{$model['price']}">
                    </div>
                </div>
                <!--库存-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">库存</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="库存" name="stock" value="{$model['stock']}">
                    </div>
                </div>
                <!--虚拟销量-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">虚拟销量</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="虚拟销量" name="virtual_sales" value="{$model['virtual_sales']}">
                    </div>
                </div>
                <!--其他状态-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">上架</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="radio" name="state" value="1" {:$model['state']==1?'checked':''} />是
                        </label>
                        <label>
                            <input type="radio" name="state" value="0" {:$model['state']==0?'checked':''}>否
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">是否热卖</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="radio" name="is_hot" value="1" {:$model['is_hot']==1?'checked':''} />是
                        </label>
                        <label>
                            <input type="radio" name="is_hot" value="0" {:$model['is_hot']==0?'checked':''}>否
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">是否精品</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="radio" name="is_best" value="1" {:$model['is_best']==1?'checked':''} />是
                        </label>
                        <label>
                            <input type="radio" name="is_best" value="0" {:$model['is_best']==0?'checked':''}>否
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">是否特价</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="radio" onclick="isSpecial(1)" name="is_special" value="1" {:$model['is_special']==1?'checked':''} />是
                        </label>
                        <label>
                            <input type="radio" onclick="isSpecial(0)" name="is_special" value="0" {:$model['is_special']==0?'checked':''}>否
                        </label>
                    </div>
                </div>
                <div class="form-group" id="special" style="display: none">
                    <label class="col-sm-2 control-label">特价时间</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="text" class="form-control start_time" name="special_time[start]" value="" />
                        </label>
                         ~
                        <label>
                            <input type="text" class="form-control end_time" name="special_time[end]" value="" >
                        </label>
                    </div>
                </div>
                <div class="form-group" id="special_price" style="display: none">
                    <label class="col-sm-2 control-label">特价</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="特价" name="special_price" value="{$model['special_price']}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">是否免运费</label>
                    <div class="col-sm-10">
                        <label>
                            <input type="radio" onclick="isShip(1);" name="is_ship" value="1" {:$model['is_special']==1?'checked':''} />是
                        </label>
                        <label>
                            <input type="radio" onclick="isShip(0);" name="is_ship" value="0" {:$model['is_special']==0?'checked':''}>否
                        </label>
                        <label>
                            <input type="radio" onclick="isShip(2);" name="is_ship" value="2" {:$model['is_special']==2?'checked':''}>固定运费
                        </label>
                    </div>
                </div>
                <div class="form-group" id="fares" style="display: none">
                    <label class="col-sm-2 control-label">运费</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" placeholder="运费" name="fare" value="{$model['fare']}">
                    </div>
                </div>
            </div>
            <!--商品详情、规格说明-->
            <div class="tab-pane" id="goods_content">
                <div class="form-group">
                    <label class="col-sm-2 control-label">商品详情</label>
                    <div class="col-sm-10">
                        <!-- 加载编辑器的容器 -->
                        <script id="container" name="content" type="text/plain">{:htmlspecialchars_decode($model['content'])}</script>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">规格说明</label>
                    <div class="col-sm-10">
                        <!-- 加载编辑器的容器 -->
                        <script id="normBrief" name="norm_brief" type="text/plain">{:htmlspecialchars_decode($model['norm_brief'])}</script>
                    </div>
                </div>
            </div>
            <!--商品规格选择-->
            <div class="tab-pane" id="goods_spec">
                <div class="form-group">
                    <label class="col-sm-2 control-label">选择规格</label>
                    <div class="col-sm-10">
                        <select name="pid" class="form-control">
                            <option value="0">请选择</option>
                            {volist name="spec" id="vl"}
                            <option value="{$vl['id']}">{$vl['spec_name']}</option>
                            {/volist}
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <!-- /.box-body -->

    <div class="box-footer">
        <button type="button" onclick="$.common.submitForm()" class="col-sm-offset-2 btn  btn-info">保存</button>
    </div>
</div>

{/block}


{block name="script"}
<!-- 配置文件 -->
<script type="text/javascript" src="/assets/ueditor1_4_3_3/ueditor.config.js"></script>
<!-- 编辑器源码文件 -->
<script type="text/javascript" src="/assets/ueditor1_4_3_3/ueditor.all.js"></script>

<script>
    var ue1 = UE.getEditor('container');
    var ue2 = UE.getEditor('normBrief');
    //引用上传组件
    layui.use(['upload','laydate'],function(){
        var upload = layui.upload;
        var laydate = layui.laydate;
        $.common.fileUpload(upload,'.upload-img')
        //执行一个laydate实例
        laydate.render({
            elem: '.end_time' //指定元素
            ,type: 'datetime' //默认，可不填
            ,min: 1
            ,max: '2080-12-31'
        });
        laydate.render({
            elem: '.start_time' //指定元素
            ,type: 'datetime' //默认，可不填
            ,min: 1
            ,max: '2080-12-31'
        });
    })
    var rule = new Object();
    {volist name="spec" id="val"}

    {/volist}
    function isShip(str){
        if(str == 2){
            $('#fares').show();
        }else{
            $('#fares').hide();
        }
    }
    function isSpecial(str){
        if(str == 1){
            $('#special').show();
            $('#special_price').show();
        }else{
            $('#special').hide();
            $('#special_price').hide();
        }
    }
</script>
{/block}